{% extends 'generic.html' %}

{% load staticfiles %}
{% block title %}Buscar bares{% endblock %}

{% block extrahead %}
	<style>

      #map {
        height: 80%;
				min-height: 80vh;
      }
    </style>
{% endblock extrahead %}
{% block main %}

<p><a href="{% url 'bar_create_view' %}">Agregar nuevo bar...</a></p>

<h1 class="major">Buscar bares...</h1>

<form method="post" action="">
	<div class="row uniform">
		<div class="12u$">
			<input type="text" name="direccion" id="direccion" value="" placeholder="Name" />
		</div>

		<div class="12u$">
				<input type="submit" value="Buscar" class="special" />
		</div>
	</div>
</form>

<table class="table table-bordered table-condensed table-hover table-striped" >
  <thead>
    <th>Bar</th>
    <th>Direccion</th>
    <th>Ciudad</th>
  </thead>
  <tbody>
    {% for b in object_list %}

        <tr>
          <td><a href="{% url 'bar_detail_view' b.id %}">{{b.nombre}}</a></td>
          <td><a href="{% url 'bar_detail_view' b.id %}">{{b.direccion}}</a></td>
          <td><a href="{% url 'bar_detail_view' b.id %}">{{b.ciudad}}</a></td>
        </tr>
    {% endfor %}
  </tbody>
</table>

<div id="map"></div>
<script>
  var map;
  function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
      center: {lat: {{location_centro_de_busqueda.latitude}}, lng: {{location_centro_de_busqueda.longitude}} },
      zoom: 14,
    });

		{% for b in object_list %}
		  {% if b.coordenadas %}
				var bar_{{b.id}}_marker = new google.maps.Marker({
		    	position: { lat:{{b.coordenadas.y}}, lng:{{b.coordenadas.x}} },
		    	map: map,
		    	title: '{{b.nombre}}'
	  		});
			{% endif %}
		{% endfor %}
  }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC7CRt0SLNHRJS0I9UkXupGNZiE1kEO2mM&callback=initMap"
async defer></script>



{% endblock main %}
